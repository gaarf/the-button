(this.webpackJsonpthe_button=this.webpackJsonpthe_button||[]).push([[0],{186:function(e){e.exports=JSON.parse('[{"constant":true,"inputs":[],"name":"WAIT_TIME","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function","signature":"0x388aef5c"},{"constant":true,"inputs":[],"name":"lastBlock","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function","signature":"0x806b984f"},{"constant":true,"inputs":[],"name":"COST","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function","signature":"0xbf8fbbd2"},{"constant":true,"inputs":[],"name":"lastParticipant","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function","signature":"0xbfe7e4e3"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor","signature":"constructor"},{"constant":true,"inputs":[],"name":"age","outputs":[{"name":"_age","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function","signature":"0x262a9dff"},{"constant":true,"inputs":[],"name":"expired","outputs":[{"name":"_expired","type":"bool"}],"payable":false,"stateMutability":"view","type":"function","signature":"0x4c2067c7"},{"constant":false,"inputs":[],"name":"press_button","outputs":[],"payable":true,"stateMutability":"payable","type":"function","signature":"0x0736783d"},{"constant":false,"inputs":[],"name":"claim_treasure","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function","signature":"0xaef4da6b"},{"constant":false,"inputs":[],"name":"reset","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function","signature":"0xd826f88f"}]')},237:function(e,t,n){e.exports=n(487)},289:function(e,t){},311:function(e,t){},313:function(e,t){},376:function(e,t){},487:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(13),i=n.n(c),o=n(178),u=n(494),s=n(497),l=n(495),p=n(38),b=n(68),f=new o.default(new p.TypeStyle({autoGenerateTag:!0}));b.setupPage("#root"),b.normalize(),f.registerTheme("default",{color:{bg:"white",text:"#111"},font:{family:"sans-serif",size:14},unit:8,border:"1px solid #CCC",mixin:b},(function(e){var t=e.color,n=e.font;return{"@global":{body:{backgroundColor:t.bg,fontFamily:n.family,fontSize:n.size,color:t.text}}}}));var m=function(e){var t=e.children;return f.changeTheme("default"),r.a.createElement(u.a,{aesthetic:f,children:t})},d=Object(s.a)(f),y=(Object(l.a)(f),n(26)),g=n(496),h=n(12),v=g.g.create({position:h.a.BOTTOM_RIGHT});function w(e,t,n){v.show(Object(y.a)({message:e},t),n)}var x=n(20),E=n(19),O=n.n(E),k=function(e){var t,n,a=e.isYou,c=(e.waitTime,e.ethCost),i=e.lastParticipant,o=e.age,u=d((function(e){var t=e.border,n=e.mixin,a=e.color,r=e.unit;return{info:Object(y.a)({},n.attachToBottom,{backgroundColor:a.bg,borderTop:t,padding:r,"@selectors":{"> ul > li > *":{marginRight:r}}})}})),s=Object(x.a)(u,2),l=s[0],p=s[1];return r.a.createElement("div",{className:p(l.info)},r.a.createElement("ul",{className:p("bp3-list-unstyled","bp3-running-text")},r.a.createElement("li",null,r.a.createElement("strong",null,"Cost:"),r.a.createElement("span",null,c)),Number(i)>0&&r.a.createElement("li",null,r.a.createElement("strong",null,"Last Participant:"),a&&r.a.createElement(g.f,{round:!0},"YOU!"),r.a.createElement("a",{href:"https://rinkeby.etherscan.io/address/".concat(i),rel:"noopener noreferrer",target:"_blank"},r.a.createElement("code",null,i)),r.a.createElement("span",null,(n="block","".concat(t=o," ").concat(n).concat(1!==t?"s":""))," ago"))))},j=n(97),T=n.n(j);var C=n(186),M=function(){var e=Object(a.useState)(),t=Object(x.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(),o=Object(x.a)(i,2),u=o[0],s=o[1],l=Object(a.useState)(!1),p=Object(x.a)(l,2),b=p[0],f=p[1],m=Object(a.useState)(),d=Object(x.a)(m,2),y=d[0],h=d[1],v=Object(a.useState)(),E=Object(x.a)(v,2),j=E[0],M=E[1],S=function(){return M(Date.now())};Object(a.useEffect)((function(){var e;return function(){var e=window,t=e.ethereum,n=e.location,a=e.web3,r=function(){return n.reload(!0)};return new Promise((function(e,n){return O.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(!t){c.next=12;break}return t.autoRefreshOnNetworkChange=!1,c.next=4,O.a.awrap(t.enable());case 4:if(t.on("networkChanged",r),t.on("accountsChanged",r),"0x4"===t.chainId){c.next=9;break}return n(new Error("Please select the Rinkeby Test Network!")),c.abrupt("return");case 9:e(new T.a(t)),c.next=13;break;case 12:a?e(new T.a(a.currentProvider)):n(new Error("Please install and enable MetaMask!"));case 13:case"end":return c.stop()}}))}))}().then((function(t){return e=t}),h).then((function(){var t,n,a,r;return O.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:return i.next=4,O.a.awrap(e.eth.getAccounts());case 4:t=i.sent,n=Object(x.a)(t,1),a=n[0],r=new e.eth.Contract(C,"0x4D83de30Ba3c1779288adda0f1C6078Ac7c3238f"),c({web3:e,account:a,contract:r}),e.eth.subscribe("newBlockHeaders",(function(e,t){var n=t.number;S(),w("New block #".concat(n),{intent:"none",icon:"code-block"})})),r.events.allEvents((function(){S(),w("Something happened!",{intent:"warning",icon:"warning-sign"})}));case 11:case"end":return i.stop()}}))})),function(){e&&e.eth.clearSubscriptions((function(){return!0}))}}),[]),Object(a.useEffect)((function(){if(n){var e="COST,WAIT_TIME,expired,lastParticipant,age".split(",");Promise.all(e.map((function(e){return n.contract.methods[e]().call()}))).then((function(e){var t=Object(x.a)(e,5),a=t[0],r=t[1],c=t[2],i=t[3],o=t[4];s({cost:a,ethCost:"".concat(n.web3.utils.fromWei(a,"ether")," ETH"),age:Number(o),waitTime:Number(r),expired:c,lastParticipant:i,isYou:i===n.account})}))}}),[n,j]);var _=(null===u||void 0===u?void 0:u.expired)&&u.isYou,N=u&&u.age/(u.waitTime+1),P=(null===u||void 0===u?void 0:u.isYou)&&Number(N)<1,I=(null===u||void 0===u?void 0:u.expired)&&!u.isYou;return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.a,{intent:"danger",isOpen:!!y,onConfirm:function(){return h(void 0)}},y&&y.message),u&&r.a.createElement(r.a.Fragment,null,P?r.a.createElement(g.c,{title:"Please wait ".concat(u.waitTime," blocks"),intent:"primary"},r.a.createElement("p",null,"If nobody else clicks the button during that time, you win."),r.a.createElement(g.d,{value:N})):r.a.createElement(g.b,{large:!0,disabled:b||I,onClick:function(){var e,t,a;return O.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=(e=n).contract,a=e.account,f(!0),r.prev=2,!_){r.next=10;break}return r.next=6,O.a.awrap(t.methods.claim_treasure().send({from:a}));case 6:return w("You got the prize!",{intent:"success",icon:"download"}),S(),f(!1),r.abrupt("return");case 10:return r.next=12,O.a.awrap(t.methods.press_button().send({from:a,value:u.cost}));case 12:S(),r.next=17;break;case 15:r.prev=15,r.t0=r.catch(2);case 17:return r.prev=17,f(!1),r.finish(17);case 20:case"end":return r.stop()}}),null,null,[[2,15,17,20]])},intent:_?"success":"none",icon:b&&r.a.createElement(g.e,{size:g.e.SIZE_SMALL})},b?"Standby...":_?"Click to claim!":I?"Winner must claim":"Click to play!"),r.a.createElement(k,u)))};function S(){var e=d((function(e){var t=e.unit,n=e.border,a=e.mixin;return{container:Object(y.a)({},a.newLayer,{},a.vertical,{"@selectors":{"> header":Object(y.a)({},a.horizontallyCenterChildren,{borderBottom:n,paddingTop:t}),"> main":Object(y.a)({},a.flex,{},a.centerCenter,{margin:"auto",padding:t})}})}})),t=Object(x.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{className:a(n.container)},r.a.createElement("header",null,r.a.createElement("h3",{className:a("bp3-heading")},"The Button")),r.a.createElement("main",null,r.a.createElement(M,null)))}n(485),n(486);var _=function(){return r.a.createElement(m,null,r.a.createElement(S,null))};i.a.render(r.a.createElement(_,null),document.getElementById("root"))}},[[237,1,2]]]);
//# sourceMappingURL=main.702f1ecb.chunk.js.map